<!DOCTYPE html>
<html class="writer-html5" lang="python" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Python API Examples &mdash; rNets  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=e7352e39" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=eafc0fe6" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=d048f138"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Published article" href="published_article.html" />
    <link rel="prev" title="Command-line Examples" href="command_line.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            rNets
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Quick Start</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../quick_start/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quick_start/basic_usage.html">Basic Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quick_start/command_line_help.html">Command-line help</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quick_start/file_formats.html">File Formats</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="command_line.html">Command-line Examples</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Python API Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#my-first-network">My first Network</a></li>
<li class="toctree-l2"><a class="reference internal" href="#drawing-a-thermodynamic-graph">Drawing a thermodynamic graph</a></li>
<li class="toctree-l2"><a class="reference internal" href="#drawing-a-kinetic-graph">Drawing a kinetic graph</a></li>
<li class="toctree-l2"><a class="reference internal" href="#using-different-energy-units">Using different energy units</a></li>
<li class="toctree-l2"><a class="reference internal" href="#formatting-our-graph">Formatting our graph</a></li>
<li class="toctree-l2"><a class="reference internal" href="#integration-with-other-software-pykinetic-thermo">Integration with other software: Pykinetic (thermo)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#integration-with-other-software-pykinetic-kinetic">Integration with other software: Pykinetic (kinetic)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="published_article.html">Published article</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Python API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api/rnets.html">rnets</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">About</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../about/developers.html">Developers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../about/citation.html">Citation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../about/contribution.html">Contribution</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">rNets</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Python API Examples</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/examples/python_api.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="python-api-examples">
<h1>Python API Examples<a class="headerlink" href="#python-api-examples" title="Link to this heading"></a></h1>
<p>In this section we will cover examples using directly the python API interface
instead of the command line. The usage of the python API facilitates the
integration of python libraries such as pykinetic, which will also be covered
in the examples.</p>
<section id="my-first-network">
<h2>My first Network<a class="headerlink" href="#my-first-network" title="Link to this heading"></a></h2>
<p>To introduce the basic components of the python API of rNets we will create
a very simple reaction network, which is shown below:</p>
<p class="centered">
<strong><div class="graphviz"><img src="../_images/graphviz-f8d76ceab5fa091ce1545aa9b9a844581201bc5a.png" alt="example_01" class="graphviz" /></div>
</strong></p><p>The first thing is importing the appropriate classes. The <code class="code docutils literal notranslate"><span class="pre">Network</span></code> class
is within the struct <code class="code docutils literal notranslate"><span class="pre">struct</span></code> module</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">rnets.struct</span> <span class="kn">import</span> <span class="n">Network</span>
</pre></div>
</div>
<p>A network is composed of <code class="code docutils literal notranslate"><span class="pre">Compound</span></code> and <code class="code docutils literal notranslate"><span class="pre">Reaction</span></code> objects, are also
in the same module</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">rnets.struct</span> <span class="kn">import</span> <span class="n">Compound</span><span class="p">,</span> <span class="n">Reaction</span>
</pre></div>
</div>
<p>Now that we have the basic building blocks we can proceed to define our different
compounds, namely A, B, C and D</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">Compound</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="n">energy</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span><span class="n">idx</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">Compound</span><span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">Compound</span><span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">D</span> <span class="o">=</span> <span class="n">Compound</span><span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">,</span><span class="o">-</span><span class="mf">2.0</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<p>Here, the minimal parameters needed to define a compound are: <code class="code docutils literal notranslate"><span class="pre">name</span></code>
, <code class="code docutils literal notranslate"><span class="pre">energy</span></code>, <code class="code docutils literal notranslate"><span class="pre">idx</span></code> . The default energy unit is <code class="code docutils literal notranslate"><span class="pre">eV</span></code> so
according to the previous code, <code class="code docutils literal notranslate"><span class="pre">B</span></code> is <code class="code docutils literal notranslate"><span class="pre">1eV</span></code> higher in energy than
<code class="code docutils literal notranslate"><span class="pre">A</span></code> while <code class="code docutils literal notranslate"><span class="pre">D</span></code> is <code class="code docutils literal notranslate"><span class="pre">2eV</span></code> lower in energy. The <code class="code docutils literal notranslate"><span class="pre">idx</span></code> value
is used to uniquely identify each compound. This allows more freedom to the
value of <code class="code docutils literal notranslate"><span class="pre">name</span></code> as there are no constraints on the text that can be used.</p>
<p>After defining the compounds, we can now proceed to define the reactions:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">reactants</span> <span class="o">=</span> <span class="p">(</span><span class="n">A</span><span class="p">,)</span>
<span class="n">products</span> <span class="o">=</span> <span class="p">(</span><span class="n">B</span><span class="p">,)</span>
<span class="n">r1</span> <span class="o">=</span> <span class="n">Reaction</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;r1&#39;</span><span class="p">,</span>
              <span class="n">compounds</span><span class="o">=</span><span class="p">(</span><span class="n">reactants</span><span class="p">,</span><span class="n">products</span><span class="p">),</span>
              <span class="n">energy</span><span class="o">=</span><span class="mf">20.0</span><span class="p">,</span>
              <span class="n">idx</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">r2</span> <span class="o">=</span> <span class="n">Reaction</span><span class="p">(</span><span class="s1">&#39;r2&#39;</span><span class="p">,((</span><span class="n">B</span><span class="p">,</span><span class="n">C</span><span class="p">),(</span><span class="n">D</span><span class="p">,)),</span><span class="mf">20.0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>The <code class="code docutils literal notranslate"><span class="pre">name</span></code> and <code class="code docutils literal notranslate"><span class="pre">idx</span></code> parameters are used to identify the reaction
in an user-friendly and code-friendly, respectively, but have no effect on the
final representation. The <code class="code docutils literal notranslate"><span class="pre">compounds</span></code> parameter is a tuple composed from
reactants and products, in both cases a tuple containing 1 or more
<code class="code docutils literal notranslate"><span class="pre">Compounds</span></code> . The <code class="code docutils literal notranslate"><span class="pre">energy</span></code> corresponds to the energy of the
transition state corresponding to the reaction. In these examples the transition
states are <code class="code docutils literal notranslate"><span class="pre">20eV</span></code> higher than <code class="code docutils literal notranslate"><span class="pre">A</span></code> and <code class="code docutils literal notranslate"><span class="pre">C</span></code> .</p>
<p>Finally we proceed to create the network:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">nw</span> <span class="o">=</span> <span class="n">Network</span><span class="p">(</span><span class="n">compounds</span><span class="o">=</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="n">D</span><span class="p">),</span><span class="n">reactions</span><span class="o">=</span><span class="p">(</span><span class="n">r1</span><span class="p">,</span><span class="n">r2</span><span class="p">))</span>
</pre></div>
</div>
<p>This is quite straightforward as we have all the pieces together. Putting
together all the previous code snippets:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">rnets.struct</span> <span class="kn">import</span> <span class="n">Network</span><span class="p">,</span> <span class="n">Compound</span><span class="p">,</span> <span class="n">Reaction</span>

<span class="n">A</span> <span class="o">=</span> <span class="n">Compound</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">Compound</span><span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">Compound</span><span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">D</span> <span class="o">=</span> <span class="n">Compound</span><span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">,</span><span class="o">-</span><span class="mf">2.0</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>

<span class="n">r1</span> <span class="o">=</span> <span class="n">Reaction</span><span class="p">(</span><span class="s1">&#39;r1&#39;</span><span class="p">,((</span><span class="n">A</span><span class="p">,),(</span><span class="n">B</span><span class="p">,)),</span><span class="mf">20.0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="n">r2</span> <span class="o">=</span> <span class="n">Reaction</span><span class="p">(</span><span class="s1">&#39;r2&#39;</span><span class="p">,((</span><span class="n">B</span><span class="p">,</span><span class="n">C</span><span class="p">),(</span><span class="n">D</span><span class="p">,)),</span><span class="mf">20.0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

<span class="n">nw</span> <span class="o">=</span> <span class="n">Network</span><span class="p">(</span><span class="n">compounds</span><span class="o">=</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="n">D</span><span class="p">),</span><span class="n">reactions</span><span class="o">=</span><span class="p">(</span><span class="n">r1</span><span class="p">,</span><span class="n">r2</span><span class="p">))</span>
</pre></div>
</div>
<p>As we now have the network created we can proceed to draw the graphs which is
in the topic of the next two examples.</p>
</section>
<section id="drawing-a-thermodynamic-graph">
<h2>Drawing a thermodynamic graph<a class="headerlink" href="#drawing-a-thermodynamic-graph" title="Link to this heading"></a></h2>
<p>For an introduction to the different components of a <code class="code docutils literal notranslate"><span class="pre">Network</span></code> please
check the <a class="reference internal" href="#my-first-network">My first Network</a></p>
<p>To draw the reaction network we will use the <code class="code docutils literal notranslate"><span class="pre">plotter</span></code> module. As in this
example we will be coloring the nodes based on the energies of the compounds and
the color and thickness of the of the edges based on the barriers, we will
specifically use the <code class="code docutils literal notranslate"><span class="pre">thermo</span></code> submodule. In the <a class="reference internal" href="#drawing-a-kinetic-graph">Drawing a kinetic graph</a>
we use the <code class="code docutils literal notranslate"><span class="pre">kinetic</span></code> instead.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">rnets.plotter.thermo</span> <span class="kn">import</span> <span class="n">build_dotgraph</span>
</pre></div>
</div>
<p>Together with the network generation we have the following code:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">rnets.struct</span> <span class="kn">import</span> <span class="n">Network</span><span class="p">,</span> <span class="n">Compound</span><span class="p">,</span> <span class="n">Reaction</span>
<span class="kn">from</span> <span class="nn">rnets.plotter.thermo</span> <span class="kn">import</span> <span class="n">build_dotgraph</span>

<span class="n">A</span> <span class="o">=</span> <span class="n">Compound</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">Compound</span><span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">Compound</span><span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">D</span> <span class="o">=</span> <span class="n">Compound</span><span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">,</span><span class="o">-</span><span class="mf">2.0</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>

<span class="n">r1</span> <span class="o">=</span> <span class="n">Reaction</span><span class="p">(</span><span class="s1">&#39;r1&#39;</span><span class="p">,((</span><span class="n">A</span><span class="p">,),(</span><span class="n">B</span><span class="p">,)),</span><span class="mf">20.0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="n">r2</span> <span class="o">=</span> <span class="n">Reaction</span><span class="p">(</span><span class="s1">&#39;r2&#39;</span><span class="p">,((</span><span class="n">B</span><span class="p">,</span><span class="n">C</span><span class="p">),(</span><span class="n">D</span><span class="p">,)),</span><span class="mf">20.0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

<span class="n">nw</span> <span class="o">=</span> <span class="n">Network</span><span class="p">(</span><span class="n">compounds</span><span class="o">=</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="n">D</span><span class="p">),</span><span class="n">reactions</span><span class="o">=</span><span class="p">(</span><span class="n">r1</span><span class="p">,</span><span class="n">r2</span><span class="p">))</span>
</pre></div>
</div>
<p>Now, we proceed to the generation of the dotfile contents and to write them:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">build_dotgraph</span><span class="p">(</span><span class="n">nw</span><span class="p">)</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;example1.dot&quot;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">of</span><span class="p">:</span>
    <span class="n">of</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">graph</span><span class="p">))</span>
</pre></div>
</div>
<p>After we have generated our <code class="code docutils literal notranslate"><span class="pre">.dot</span></code> file all that remains is to transform
it into an image format, which we can do with any of graphviz's tools. As we
are doing these examples in python we will use python to call the <code class="code docutils literal notranslate"><span class="pre">dot</span></code>
tool:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">subprocess</span>
<span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s1">&#39;dot -Tpng example1.dot -o example1.png&#39;</span><span class="p">,</span><span class="n">shell</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>With this we will have generated a basic reaction network completely using rNets'
python API. Putting all together:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">subprocess</span>

<span class="kn">from</span> <span class="nn">rnets.struct</span> <span class="kn">import</span> <span class="n">Network</span><span class="p">,</span> <span class="n">Compound</span><span class="p">,</span> <span class="n">Reaction</span>
<span class="kn">from</span> <span class="nn">rnets.plotter.thermo</span> <span class="kn">import</span> <span class="n">build_dotgraph</span>

<span class="c1"># Creation of the reaction network</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">Compound</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">Compound</span><span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">Compound</span><span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">D</span> <span class="o">=</span> <span class="n">Compound</span><span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">,</span><span class="o">-</span><span class="mf">2.0</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>

<span class="n">r1</span> <span class="o">=</span> <span class="n">Reaction</span><span class="p">(</span><span class="s1">&#39;r1&#39;</span><span class="p">,((</span><span class="n">A</span><span class="p">,),(</span><span class="n">B</span><span class="p">,)),</span><span class="mf">20.0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="n">r2</span> <span class="o">=</span> <span class="n">Reaction</span><span class="p">(</span><span class="s1">&#39;r2&#39;</span><span class="p">,((</span><span class="n">B</span><span class="p">,</span><span class="n">C</span><span class="p">),(</span><span class="n">D</span><span class="p">,)),</span><span class="mf">20.0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

<span class="n">nw</span> <span class="o">=</span> <span class="n">Network</span><span class="p">(</span><span class="n">compounds</span><span class="o">=</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="n">D</span><span class="p">),</span><span class="n">reactions</span><span class="o">=</span><span class="p">(</span><span class="n">r1</span><span class="p">,</span><span class="n">r2</span><span class="p">))</span>

<span class="c1"># Creation of the graph and saving it as a .dot file.</span>
<span class="n">graph</span> <span class="o">=</span> <span class="n">build_dotgraph</span><span class="p">(</span><span class="n">nw</span><span class="p">)</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;example.dot&quot;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">of</span><span class="p">:</span>
    <span class="n">of</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">graph</span><span class="p">))</span>

<span class="c1"># Generating a PNG from the created .dot file</span>
<span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s1">&#39;dot -Tpng example.dot -o example.png&#39;</span><span class="p">,</span><span class="n">shell</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="drawing-a-kinetic-graph">
<h2>Drawing a kinetic graph<a class="headerlink" href="#drawing-a-kinetic-graph" title="Link to this heading"></a></h2>
<p>For an introduction to the different components of a <code class="code docutils literal notranslate"><span class="pre">Network</span></code> please
check the <a class="reference internal" href="#my-first-network">My first Network</a></p>
<p>To draw the reaction network we will use the <code class="code docutils literal notranslate"><span class="pre">plotter</span></code> module. As in this
example we will be coloring the nodes based on the energies of the compounds and
the color and thickness of the of the edges based on the barriers, we will
specifically use the <code class="code docutils literal notranslate"><span class="pre">kinetic</span></code> submodule. In the <a class="reference internal" href="#drawing-a-thermodynamic-graph">Drawing a thermodynamic graph</a>
we use the <code class="code docutils literal notranslate"><span class="pre">thermo</span></code> instead.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">rnets.plotter.kinetic</span> <span class="kn">import</span> <span class="n">build_dotgraph</span>
</pre></div>
</div>
<p>Contrary to the <a class="reference internal" href="#drawing-a-thermodynamic-graph">Drawing a thermodynamic graph</a> example, here it is needed to
modify the creation of the network, as we need to provide information about the
concentrations of each compound. The units of the concentrations have to be
consistent with the energy units, since the rates of the reactions will be
computed based on the energies and concentrations.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">rnets.struct</span> <span class="kn">import</span> <span class="n">Network</span><span class="p">,</span> <span class="n">Compound</span><span class="p">,</span> <span class="n">Reaction</span>
<span class="kn">from</span> <span class="nn">rnets.plotter.kinetic</span> <span class="kn">import</span> <span class="n">build_dotgraph</span>

<span class="n">A</span> <span class="o">=</span> <span class="n">Compound</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">conc</span><span class="o">=</span><span class="mf">0.75</span><span class="p">)</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">Compound</span><span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">conc</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">Compound</span><span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">conc</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="n">D</span> <span class="o">=</span> <span class="n">Compound</span><span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">,</span><span class="o">-</span><span class="mf">2.0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">conc</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>

<span class="n">r1</span> <span class="o">=</span> <span class="n">Reaction</span><span class="p">(</span><span class="s1">&#39;r1&#39;</span><span class="p">,((</span><span class="n">A</span><span class="p">,),(</span><span class="n">B</span><span class="p">,)),</span><span class="mf">20.0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="n">r2</span> <span class="o">=</span> <span class="n">Reaction</span><span class="p">(</span><span class="s1">&#39;r2&#39;</span><span class="p">,((</span><span class="n">B</span><span class="p">,</span><span class="n">C</span><span class="p">),(</span><span class="n">D</span><span class="p">,)),</span><span class="mf">20.0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

<span class="n">nw</span> <span class="o">=</span> <span class="n">Network</span><span class="p">(</span><span class="n">compounds</span><span class="o">=</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="n">D</span><span class="p">),</span><span class="n">reactions</span><span class="o">=</span><span class="p">(</span><span class="n">r1</span><span class="p">,</span><span class="n">r2</span><span class="p">))</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For the example we are going to use arbitrary numbers, but these numbers can
be read from an existing file containing the output of a kinetic simulation
software.</p>
</div>
<p>Now, we proceed to the generation of the dotfile contents and to write them:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">graph</span> <span class="o">=</span> <span class="n">build_dotgraph</span><span class="p">(</span><span class="n">nw</span><span class="p">)</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;example.dot&quot;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">of</span><span class="p">:</span>
    <span class="n">of</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">graph</span><span class="p">))</span>
</pre></div>
</div>
<p>After we have generated our <code class="code docutils literal notranslate"><span class="pre">.dot</span></code> file all that remains is to transform
it into an image format, which we can do with any of graphviz's tools. As we
are doing these examples in python we will use python to call the <code class="code docutils literal notranslate"><span class="pre">dot</span></code>
tool:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">subprocess</span>
<span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s1">&#39;dot -Tpng example.dot -o example.png&#39;</span><span class="p">,</span><span class="n">shell</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>With this we will have generated a basic reaction network completely using rNets'
python API. Putting all together:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">subprocess</span>

<span class="kn">from</span> <span class="nn">rnets.struct</span> <span class="kn">import</span> <span class="n">Network</span><span class="p">,</span> <span class="n">Compound</span><span class="p">,</span> <span class="n">Reaction</span>
<span class="kn">from</span> <span class="nn">rnets.plotter.kinetic</span> <span class="kn">import</span> <span class="n">build_dotgraph</span>

<span class="c1"># Creation of the reaction network</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">Compound</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">conc</span><span class="o">=</span><span class="mf">0.75</span><span class="p">)</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">Compound</span><span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">conc</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">Compound</span><span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">conc</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="n">D</span> <span class="o">=</span> <span class="n">Compound</span><span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">,</span><span class="o">-</span><span class="mf">2.0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">conc</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>

<span class="n">r1</span> <span class="o">=</span> <span class="n">Reaction</span><span class="p">(</span><span class="s1">&#39;r1&#39;</span><span class="p">,((</span><span class="n">A</span><span class="p">,),(</span><span class="n">B</span><span class="p">,)),</span><span class="mf">20.0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="n">r2</span> <span class="o">=</span> <span class="n">Reaction</span><span class="p">(</span><span class="s1">&#39;r2&#39;</span><span class="p">,((</span><span class="n">B</span><span class="p">,</span><span class="n">C</span><span class="p">),(</span><span class="n">D</span><span class="p">,)),</span><span class="mf">20.0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

<span class="n">nw</span> <span class="o">=</span> <span class="n">Network</span><span class="p">(</span><span class="n">compounds</span><span class="o">=</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="n">D</span><span class="p">),</span><span class="n">reactions</span><span class="o">=</span><span class="p">(</span><span class="n">r1</span><span class="p">,</span><span class="n">r2</span><span class="p">))</span>

<span class="c1"># Creation of the graph and saving it as a .dot file.</span>
<span class="n">graph</span> <span class="o">=</span> <span class="n">build_dotgraph</span><span class="p">(</span><span class="n">nw</span><span class="p">)</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;example.dot&quot;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">of</span><span class="p">:</span>
    <span class="n">of</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">graph</span><span class="p">))</span>

<span class="c1"># Generating a PNG from the created .dot file</span>
<span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s1">&#39;dot -Tpng example.dot -o example.png&#39;</span><span class="p">,</span><span class="n">shell</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="using-different-energy-units">
<h2>Using different energy units<a class="headerlink" href="#using-different-energy-units" title="Link to this heading"></a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Currently under construction:
Here we will cover how to prepare a chemical configuration different from the
default one and how to use it.</p>
</div>
</section>
<section id="formatting-our-graph">
<h2>Formatting our graph<a class="headerlink" href="#formatting-our-graph" title="Link to this heading"></a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Currently under construction:
Here we will cover how to prepare a graph configuration different from the
default one and how to use it.</p>
</div>
</section>
<section id="integration-with-other-software-pykinetic-thermo">
<h2>Integration with other software: Pykinetic (thermo)<a class="headerlink" href="#integration-with-other-software-pykinetic-thermo" title="Link to this heading"></a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Currently under construction:
An example of how to adapt pykinetics classes to generate a thermodynamic graph</p>
</div>
</section>
<section id="integration-with-other-software-pykinetic-kinetic">
<h2>Integration with other software: Pykinetic (kinetic)<a class="headerlink" href="#integration-with-other-software-pykinetic-kinetic" title="Link to this heading"></a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Currently under construction:
An example of how to adapt pykinetics classes to generate a kinetic graph</p>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="command_line.html" class="btn btn-neutral float-left" title="Command-line Examples" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="published_article.html" class="btn btn-neutral float-right" title="Published article" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Sergio Pablo-García.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>