<!DOCTYPE html>
<html class="writer-html5" lang="python" data-content_root="../../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>rnets.plotter.utils &mdash; rNets  documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=e7352e39" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css?v=eafc0fe6" />

  
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../../_static/documentation_options.js?v=d048f138"></script>
        <script src="../../../_static/doctools.js?v=888ff710"></script>
        <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            rNets
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Quick Start</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../quick_start/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../quick_start/basic_usage.html">Basic Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../quick_start/command_line_help.html">Command-line help</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../quick_start/file_formats.html">File Formats</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../examples/command_line.html">Command-line Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../examples/python_api.html">Python API Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../examples/published_article.html">Published article</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Python API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../api/rnets.html">rnets</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">About</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../about/developers.html">Developers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../about/citation.html">Citation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../about/contribution.html">Contribution</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">rNets</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Module code</a></li>
      <li class="breadcrumb-item active">rnets.plotter.utils</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for rnets.plotter.utils</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;Utility module for plotting reactions/compounds/networks dotfiles.</span>

<span class="sd">Attributes:</span>
<span class="sd">    C_WHITE (:obj:`Color`): Default white color.</span>
<span class="sd">    C_BLACK (:obj:`Color`): Default black color.</span>
<span class="sd">    COLORSCH (sequence of :obj:`Color`): Default colorscheme.</span>
<span class="sd">    GRAPH_ATTR_DEF (:obj:`Opts`): Default graph global attributes.</span>
<span class="sd">    NODE_ATTR_DEF (:obj:`Opts`): Default node global attributes.</span>
<span class="sd">    EDCE_ATTR_DEF (:obj:`Opts`): Default edge global attributes.</span>
<span class="sd">    BOX_TMP (str): HTML box template.</span>
<span class="sd">    LABEL_TMP (str): HTML label template.</span>
<span class="sd"> &quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">collections.abc</span> <span class="kn">import</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">Iterator</span><span class="p">,</span> <span class="n">Sequence</span>
<span class="kn">from</span> <span class="nn">enum</span> <span class="kn">import</span> <span class="n">StrEnum</span>
<span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">partial</span><span class="p">,</span> <span class="n">reduce</span>
<span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">chain</span><span class="p">,</span> <span class="n">repeat</span><span class="p">,</span> <span class="n">product</span><span class="p">,</span> <span class="n">starmap</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">NamedTuple</span>

<span class="kn">from</span> <span class="nn">..chemistry</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">ChemCfg</span>
    <span class="p">,</span> <span class="n">calc_reactions_k_norms</span>
    <span class="p">,</span> <span class="n">network_energy_normalizer</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">..dot</span> <span class="kn">import</span> <span class="n">Edge</span><span class="p">,</span> <span class="n">Graph</span><span class="p">,</span> <span class="n">Node</span><span class="p">,</span> <span class="n">Opts</span><span class="p">,</span> <span class="n">OptsGlob</span>
<span class="kn">from</span> <span class="nn">..struct</span> <span class="kn">import</span> <span class="n">Compound</span><span class="p">,</span> <span class="n">FFlags</span><span class="p">,</span> <span class="n">Network</span><span class="p">,</span> <span class="n">Reaction</span><span class="p">,</span> <span class="n">Visibility</span>
<span class="kn">from</span> <span class="nn">..colors.utils</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">Color</span>
    <span class="p">,</span> <span class="n">ColorSpace</span>
    <span class="p">,</span> <span class="n">rgb_achromatize</span>
    <span class="p">,</span> <span class="n">color_sel_lum</span>
    <span class="p">,</span> <span class="n">interp_cs</span>
    <span class="p">,</span> <span class="n">rgb_to_hexstr</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">..colors.colorschemes</span> <span class="kn">import</span> <span class="n">VIRIDIS</span><span class="p">,</span> <span class="n">Colorscheme</span>
<span class="kn">from</span> <span class="nn">..colors.palettes</span> <span class="kn">import</span> <span class="n">css</span>


<span class="n">C_WHITE</span><span class="p">:</span> <span class="n">Color</span> <span class="o">=</span> <span class="n">css</span><span class="p">[</span><span class="s2">&quot;white&quot;</span><span class="p">]</span>
<span class="n">C_BLACK</span><span class="p">:</span> <span class="n">Color</span> <span class="o">=</span> <span class="n">css</span><span class="p">[</span><span class="s2">&quot;black&quot;</span><span class="p">]</span>
<span class="n">COLORSCH</span><span class="p">:</span> <span class="n">Colorscheme</span> <span class="o">=</span> <span class="n">VIRIDIS</span>

<span class="n">GRAPH_ATTR_DEF</span><span class="p">:</span> <span class="n">Opts</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;rankdir&quot;</span><span class="p">:</span> <span class="s1">&#39;TB&#39;</span>
    <span class="p">,</span> <span class="s2">&quot;ranksep&quot;</span><span class="p">:</span> <span class="s1">&#39;0.5&#39;</span>
    <span class="p">,</span> <span class="s2">&quot;nodesep&quot;</span><span class="p">:</span> <span class="s1">&#39;0.25&#39;</span>
<span class="p">}</span>
<span class="n">NODE_ATTR_DEF</span><span class="p">:</span> <span class="n">Opts</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;shape&quot;</span><span class="p">:</span> <span class="s2">&quot;plaintext&quot;</span>
    <span class="p">,</span> <span class="s2">&quot;style&quot;</span><span class="p">:</span> <span class="s2">&quot;filled&quot;</span>
<span class="p">}</span>
<span class="n">EDGE_ATTR_DEF</span><span class="p">:</span> <span class="n">Opts</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="s2">&quot;2.&quot;</span>
<span class="p">}</span>
<span class="n">BOX_TMP</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;&lt;</span>
<span class="s2">&lt;TABLE BORDER=&quot;0&quot; CELLBORDER=&quot;0&quot; CELLSPACING=&quot;0&quot; CELLPADDING=&quot;0&quot;&gt;</span>
<span class="s2">  &lt;TR&gt;</span>
<span class="s2">    &lt;TD&gt;</span><span class="si">{0}</span><span class="s2">&lt;/TD&gt;</span>
<span class="s2">  &lt;/TR&gt;</span>
<span class="s2">&lt;/TABLE&gt;</span>
<span class="s2">&gt;</span>
<span class="s2">&quot;&quot;&quot;</span>
<span class="n">LABEL_TMP</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&lt;FONT COLOR=&quot;</span><span class="si">{0}</span><span class="s1">&quot;&gt;</span><span class="si">{1}</span><span class="s1">&lt;/FONT&gt;&#39;</span>


<div class="viewcode-block" id="HTMLFormat">
<a class="viewcode-back" href="../../../api/rnets.plotter.utils.html#rnets.plotter.utils.HTMLFormat">[docs]</a>
<span class="k">class</span> <span class="nc">HTMLFormat</span><span class="p">(</span><span class="n">StrEnum</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;HTML format for strings.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">Bold</span> <span class="o">=</span> <span class="s2">&quot;&lt;b&gt;</span><span class="si">{}</span><span class="s2">&lt;/b&gt;&quot;</span>
    <span class="n">Italic</span> <span class="o">=</span> <span class="s2">&quot;&lt;i&gt;</span><span class="si">{}</span><span class="s2">&lt;/i&gt;&quot;</span>
    <span class="n">Underscore</span> <span class="o">=</span> <span class="s2">&quot;&lt;u&gt;</span><span class="si">{}</span><span class="s2">&lt;/u&gt;&quot;</span></div>



<div class="viewcode-block" id="EdgeArgs">
<a class="viewcode-back" href="../../../api/rnets.plotter.utils.html#rnets.plotter.utils.EdgeArgs">[docs]</a>
<span class="k">class</span> <span class="nc">EdgeArgs</span><span class="p">(</span><span class="n">NamedTuple</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Situational tuple to store the filter arguments for the filter function.</span>

<span class="sd">    Notes:</span>
<span class="sd">        Internal use to avoid type checker complaints.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">react</span><span class="p">:</span> <span class="n">Reaction</span>
    <span class="n">width</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span>
    <span class="n">color</span><span class="p">:</span> <span class="n">Color</span> <span class="o">|</span> <span class="kc">None</span>
    <span class="nb">reversed</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></div>



<div class="viewcode-block" id="NodeCfg">
<a class="viewcode-back" href="../../../api/rnets.plotter.utils.html#rnets.plotter.utils.NodeCfg">[docs]</a>
<span class="k">class</span> <span class="nc">NodeCfg</span><span class="p">(</span><span class="n">NamedTuple</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Dot node general configuration.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        opts (dict of str as keys and str as values or None, optional): Dot</span>
<span class="sd">            additional global node options. Defauts to None.</span>
<span class="sd">        box_tmp (str, optional): Box template. Should have two format</span>
<span class="sd">            modificators, the first consisting on the label and the second</span>
<span class="sd">            consisting on the background color. Defaults to :obj:`BOX_TMP`</span>
<span class="sd">        font_color (:obj:`Color`, optional): Font color of the node. Defaults</span>
<span class="sd">            to :obj:`C_BLACK`</span>
<span class="sd">        font_color_alt (:obj:`Color` or None, optional): Alternative font</span>
<span class="sd">            color. If not None, would be used as the font color for dark background</span>
<span class="sd">            colors (see :obj:`calc_relative_luminance`)</span>
<span class="sd">        font_lum_threshold (float on None, optional): If :attr:`font_color_alt`</span>
<span class="sd">            is defined, the luminance threshold to use it instead of</span>
<span class="sd">            :attr:`font_color`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">opts</span><span class="p">:</span> <span class="n">Opts</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">NODE_ATTR_DEF</span>
    <span class="n">box_tmp</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">BOX_TMP</span>
    <span class="n">font_color</span><span class="p">:</span> <span class="n">Color</span> <span class="o">=</span> <span class="n">C_BLACK</span>
    <span class="n">font_color_alt</span><span class="p">:</span> <span class="n">Color</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">C_WHITE</span>
    <span class="n">font_lum_threshold</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span></div>



<div class="viewcode-block" id="EdgeCfg">
<a class="viewcode-back" href="../../../api/rnets.plotter.utils.html#rnets.plotter.utils.EdgeCfg">[docs]</a>
<span class="k">class</span> <span class="nc">EdgeCfg</span><span class="p">(</span><span class="n">NamedTuple</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Dot edge general configuration.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        opts (dict of str as keys and str as values or None, optional): Dot</span>
<span class="sd">            additional global edge options. Defauts to None.</span>
<span class="sd">        solid_color (:obj:`Color` or None, optional): If set, all lines will be</span>
<span class="sd">            draw with that color, else, the color will be decided based on the</span>
<span class="sd">            reaction energy. Defaults to None.</span>
<span class="sd">        width (float, optional): Minimum width of the edges. Defaults to 1..</span>
<span class="sd">        max_width (float or None, optional): If set, the width or the arrows</span>
<span class="sd">            will be decided based on their kinetic constant (k, see</span>
<span class="sd">            :obj:`calc_pseudo_k_constant`), using width as the minimum width</span>
<span class="sd">            and this max_width as the maximum width, if None, all the arrows</span>
<span class="sd">            will be draw with constant width.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">opts</span><span class="p">:</span> <span class="n">Opts</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">EDGE_ATTR_DEF</span>
    <span class="n">solid_color</span><span class="p">:</span> <span class="n">Color</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">width</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.</span>
    <span class="n">max_width</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="mf">5.</span></div>



<div class="viewcode-block" id="GraphCfg">
<a class="viewcode-back" href="../../../api/rnets.plotter.utils.html#rnets.plotter.utils.GraphCfg">[docs]</a>
<span class="k">class</span> <span class="nc">GraphCfg</span><span class="p">(</span><span class="n">NamedTuple</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Dot graph general configuration.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        opts (dict of str as keys and str as values or None, optional): Dot</span>
<span class="sd">            additional global graph options. Defauts to None. Defaults to</span>
<span class="sd">            :obj:`GRAPH_ATTR_DEF`.</span>
<span class="sd">        kind (str, optional): Kind of the dotgraph. Defaults to digraph.</span>
<span class="sd">        colorscheme (sequence of floats): Sequence of colors that will be</span>
<span class="sd">           interpolate to set the colors of the graph. See</span>
<span class="sd">           :obj:`interp_cs`. Defaults to :obj:`COLORSCH`.</span>
<span class="sd">        color_offset (tuple of two floats, optional): When using the energy of</span>
<span class="sd">            a node to decide its color, the offset to apply to norm. Should be</span>
<span class="sd">            a value between 0. and 1. Useful to avoid falling on the extremes</span>
<span class="sd">            of a predefined colorscheme. Defaults to (0., 0.)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">opts</span><span class="p">:</span> <span class="n">Opts</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">GRAPH_ATTR_DEF</span>
    <span class="n">kind</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;digraph&quot;</span>
    <span class="n">colorscheme</span><span class="p">:</span> <span class="n">Colorscheme</span> <span class="o">=</span> <span class="n">COLORSCH</span>
    <span class="n">color_offset</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)</span>
    <span class="n">node</span><span class="p">:</span> <span class="n">NodeCfg</span> <span class="o">=</span> <span class="n">NodeCfg</span><span class="p">()</span>
    <span class="n">edge</span><span class="p">:</span> <span class="n">EdgeCfg</span> <span class="o">=</span> <span class="n">EdgeCfg</span><span class="p">()</span></div>



<div class="viewcode-block" id="color_interp">
<a class="viewcode-back" href="../../../api/rnets.plotter.utils.html#rnets.plotter.utils.color_interp">[docs]</a>
<span class="k">def</span> <span class="nf">color_interp</span><span class="p">(</span>
    <span class="n">norm_fn</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">float</span><span class="p">],</span> <span class="nb">float</span><span class="p">]</span>
    <span class="p">,</span> <span class="n">cs</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Color</span><span class="p">]</span>
    <span class="p">,</span> <span class="n">offset</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)</span>
    <span class="p">,</span> <span class="n">cspace</span><span class="p">:</span> <span class="n">ColorSpace</span> <span class="o">=</span> <span class="s2">&quot;lab&quot;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">float</span><span class="p">],</span> <span class="n">Color</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Given a reaction network and a sequence of colors, build a color</span>
<span class="sd">    interpolation function that converts the energy of a component inside the</span>
<span class="sd">    network to the corresponding color in the color sequence.</span>

<span class="sd">    Args:</span>
<span class="sd">        n (:obj:`Network`): Reaction network.</span>
<span class="sd">        cs (sequence of :obj:`Color`): Sequence of colors to interpolate.</span>
<span class="sd">        offset (tuple of 2 float, optional): Minimum and maximum energy offsets</span>
<span class="sd">            to add to the minimum and maximum detected energies.</span>
<span class="sd">        c_space (str): Colorspace in which the interpolation will be</span>
<span class="sd">            perform. Check :obj:`ColorSpace` for available values.</span>

<span class="sd">    Returns:</span>
<span class="sd">        :obj:`Callable[[float], Color]`: </span>
<span class="sd">            A function that takes a float as input an returns a :obj:`Color` </span>
<span class="sd">            as output.</span>

<span class="sd">    Notes:</span>
<span class="sd">        The normalizer is set for the input network and thus, if an energy</span>
<span class="sd">            value that it is out of range is used as input, the normalization</span>
<span class="sd">            will follow the (under)overflow rules of :obj:`normalizer`.</span>

<span class="sd">        I found that the offset is extremely useful to avoid very dark and very</span>
<span class="sd">            bright zones of certain colorschemes.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">c_interp</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">float</span><span class="p">],</span> <span class="n">Color</span><span class="p">]</span> <span class="o">=</span> <span class="n">interp_cs</span><span class="p">(</span><span class="n">cs</span><span class="p">,</span> <span class="n">cspace</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">interp_fn</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Color</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">c_interp</span><span class="p">(</span><span class="n">norm_fn</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">interp_fn</span></div>



<div class="viewcode-block" id="fformat_to_html">
<a class="viewcode-back" href="../../../api/rnets.plotter.utils.html#rnets.plotter.utils.fformat_to_html">[docs]</a>
<span class="k">def</span> <span class="nf">fformat_to_html</span><span class="p">(</span>
    <span class="n">f</span><span class="p">:</span> <span class="n">FFlags</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">HTMLFormat</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert :obj:`FFlags` to :obj:`HTMLFormat`.</span>

<span class="sd">    Args:</span>
<span class="sd">        f (:obj:`FFlags`): FFlags to convert.</span>

<span class="sd">    Returns:</span>
<span class="sd">       :obj:`HTMLFormat`: </span>
<span class="sd">           HTML format conversion.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">match</span> <span class="n">f</span><span class="p">:</span>
        <span class="k">case</span> <span class="n">FFlags</span><span class="o">.</span><span class="n">I</span><span class="p">:</span> <span class="k">return</span> <span class="n">HTMLFormat</span><span class="o">.</span><span class="n">Italic</span>
        <span class="k">case</span> <span class="n">FFlags</span><span class="o">.</span><span class="n">B</span><span class="p">:</span> <span class="k">return</span> <span class="n">HTMLFormat</span><span class="o">.</span><span class="n">Bold</span>
        <span class="k">case</span> <span class="n">FFlags</span><span class="o">.</span><span class="n">U</span><span class="p">:</span> <span class="k">return</span> <span class="n">HTMLFormat</span><span class="o">.</span><span class="n">Underscore</span></div>



<div class="viewcode-block" id="apply_html_format">
<a class="viewcode-back" href="../../../api/rnets.plotter.utils.html#rnets.plotter.utils.apply_html_format">[docs]</a>
<span class="k">def</span> <span class="nf">apply_html_format</span><span class="p">(</span>
    <span class="n">s</span><span class="p">:</span> <span class="nb">str</span>
    <span class="p">,</span> <span class="n">fs</span><span class="p">:</span> <span class="nb">set</span><span class="p">[</span><span class="n">FFlags</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Given a set of :obj:`FFlags` apply it as HTML format labels to a string.</span>

<span class="sd">    Args:</span>
<span class="sd">        s (str): String to apply the format.</span>
<span class="sd">        fs (set of :obj:`FFlags`): Set with the formats to apply.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: with the applied HTML formats.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">reduce</span><span class="p">(</span>
        <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">:</span> <span class="n">fformat_to_html</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="p">,</span> <span class="n">fs</span>
        <span class="p">,</span> <span class="n">s</span>
    <span class="p">)</span></div>



<div class="viewcode-block" id="build_node_box">
<a class="viewcode-back" href="../../../api/rnets.plotter.utils.html#rnets.plotter.utils.build_node_box">[docs]</a>
<span class="k">def</span> <span class="nf">build_node_box</span><span class="p">(</span>
    <span class="n">s</span><span class="p">:</span> <span class="nb">str</span>
    <span class="p">,</span> <span class="n">fc</span><span class="p">:</span> <span class="n">Color</span> <span class="o">=</span> <span class="n">C_BLACK</span>
    <span class="p">,</span> <span class="n">box_tmp</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">BOX_TMP</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates an string describing a colored-background HTML with a text label</span>
<span class="sd">    in the middle. This is the typical node representation of this code.</span>

<span class="sd">    Args:</span>
<span class="sd">        s (str): String that will be used as a label.</span>
<span class="sd">        fc (:obj:`Color`, optional): Text color for the label. Defaults to black</span>
<span class="sd">             (:obj:`C_BLACK`).</span>
<span class="sd">        box_tmp (str, optional): Box template. Should have a format modificator</span>
<span class="sd">            for the text label. Defaults to :obj:`BOX_TMP`</span>
<span class="sd">    Returns:</span>
<span class="sd">        str: HTML table with the given label, background color and text color.</span>

<span class="sd">    Note:</span>
<span class="sd">        Note that :obj:`Color` follows the colorsys representation, meaning</span>
<span class="sd">            that it consists of 3 float values ranging from [0, 1].</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">box_tmp</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="n">LABEL_TMP</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="n">rgb_to_hexstr</span><span class="p">(</span><span class="n">fc</span><span class="p">),</span> <span class="n">s</span>
        <span class="p">))</span></div>



<div class="viewcode-block" id="gen_react_arrows">
<a class="viewcode-back" href="../../../api/rnets.plotter.utils.html#rnets.plotter.utils.gen_react_arrows">[docs]</a>
<span class="k">def</span> <span class="nf">gen_react_arrows</span><span class="p">(</span>
    <span class="n">rt</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Compound</span><span class="p">]</span>
    <span class="p">,</span> <span class="n">pt</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Compound</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">Compound</span><span class="p">,</span> <span class="n">Compound</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Given a set of reactants and a set of products, generate an iterator</span>
<span class="sd">    that returns every react-&gt;product combination, skipping the ones containing</span>
<span class="sd">    a not visible :obj:`Compound`.</span>

<span class="sd">    Args:</span>
<span class="sd">        rt (sequence of :obj:`Compound`): Compounds acting as reactants.</span>
<span class="sd">        pt (sequence of :obj:`Compound`): Compounds acting as products.</span>

<span class="sd">    Returns:</span>
<span class="sd">        :obj:`Iterator[tuple[Compound, Compound]]`: </span>
<span class="sd">            A consumable iterator with all the (react, product) combinations </span>
<span class="sd">            excluding the ones with non visible compounds.</span>

<span class="sd">    Note:</span>
<span class="sd">        To avoid duplicated edges due to duplicated compounds, e.g. 2H + 2O -&gt;</span>
<span class="sd">        2H2O ((H,H,O,O), (H2O,H2O)), only the unique reactants and products</span>
<span class="sd">        will be taken into account.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">filter_vis</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="nb">filter</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">visible</span> <span class="o">!=</span> <span class="n">Visibility</span><span class="o">.</span><span class="n">FALSE</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">product</span><span class="p">(</span><span class="n">filter_vis</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">rt</span><span class="p">)),</span> <span class="n">filter_vis</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">pt</span><span class="p">)))</span></div>



<div class="viewcode-block" id="build_dotnode">
<a class="viewcode-back" href="../../../api/rnets.plotter.utils.html#rnets.plotter.utils.build_dotnode">[docs]</a>
<span class="k">def</span> <span class="nf">build_dotnode</span><span class="p">(</span>
    <span class="n">c</span><span class="p">:</span> <span class="n">Compound</span>
    <span class="p">,</span> <span class="n">bc</span><span class="p">:</span> <span class="n">Color</span> <span class="o">=</span> <span class="n">C_WHITE</span>
    <span class="p">,</span> <span class="n">fc</span><span class="p">:</span> <span class="n">Color</span> <span class="o">=</span> <span class="n">C_BLACK</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Node</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a :obj:`Node` from a :obj:`Compound`.</span>

<span class="sd">    Args:</span>
<span class="sd">        c (:obj:`Compound`): Compound to be coverted.</span>
<span class="sd">        bc (:obj:`Color`, optional): RGB color of the background. Defaults to</span>
<span class="sd">            white.</span>
<span class="sd">        fc (:obj:`Color`, optional): RGB color of the text. Defaults to black</span>
<span class="sd">            (:obj:`C_BLACK`).</span>

<span class="sd">    Returns:</span>
<span class="sd">        :obj:`Node`: </span>
<span class="sd">            Dot node with the given font and background colors.</span>
<span class="sd">            Inherits applies the format flags and the dot opts in</span>
<span class="sd">            :obj:`Compound`.</span>

<span class="sd">    Note:</span>
<span class="sd">        To allow custom labels, this function will check for &quot;label&quot; in</span>
<span class="sd">            :attr:`Compound.opts`, if found, it will use it instead of the</span>
<span class="sd">            layer.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">l</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">opts</span><span class="p">[</span><span class="s2">&quot;label&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">opts</span> <span class="ow">and</span> <span class="s2">&quot;label&quot;</span> <span class="ow">in</span> <span class="n">c</span><span class="o">.</span><span class="n">opts</span><span class="p">)</span> <span class="k">else</span> <span class="n">c</span><span class="o">.</span><span class="n">name</span>
    <span class="k">return</span> <span class="n">Node</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="n">l</span>
        <span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="n">c</span><span class="o">.</span><span class="n">opts</span> <span class="ow">or</span> <span class="p">{}</span> <span class="o">|</span> <span class="p">{</span>
            <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="n">build_node_box</span><span class="p">(</span>
                <span class="n">s</span><span class="o">=</span><span class="n">apply_html_format</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">fflags</span><span class="p">)</span> <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">fflags</span> <span class="k">else</span> <span class="n">l</span>
                <span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="n">fc</span>
            <span class="p">)</span>
            <span class="p">,</span> <span class="s2">&quot;fillcolor&quot;</span><span class="p">:</span> <span class="s1">&#39;&quot;</span><span class="si">{}</span><span class="s1">&quot;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">rgb_to_hexstr</span><span class="p">(</span>
                <span class="n">c</span><span class="o">=</span><span class="n">bc</span>
                <span class="p">,</span> <span class="n">inc_hash</span><span class="o">=</span><span class="kc">True</span>
            <span class="p">))</span>
        <span class="p">}</span>
    <span class="p">)</span></div>



<div class="viewcode-block" id="build_dotedge">
<a class="viewcode-back" href="../../../api/rnets.plotter.utils.html#rnets.plotter.utils.build_dotedge">[docs]</a>
<span class="k">def</span> <span class="nf">build_dotedge</span><span class="p">(</span>
    <span class="n">o</span><span class="p">:</span> <span class="nb">str</span>
    <span class="p">,</span> <span class="n">t</span><span class="p">:</span> <span class="nb">str</span>
    <span class="p">,</span> <span class="n">opts</span><span class="p">:</span> <span class="n">Opts</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">,</span> <span class="n">c</span><span class="p">:</span> <span class="n">Color</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">,</span> <span class="n">w</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Edge</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Build a dot :obj:`Edge`.</span>

<span class="sd">    Args:</span>
<span class="sd">        o (str): Origin node.</span>
<span class="sd">        t (str): Target node.</span>
<span class="sd">        opts (:obj:`Opts` or None, optional): Graphviz attributes of the</span>
<span class="sd">            edge. Defaults to None.</span>
<span class="sd">        c (:obj:`Color` or None, optional): Color of edge. Defaults to None.</span>
<span class="sd">        w (float or None, optional): Edge width. Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        :obj:`Edge`:</span>
<span class="sd">        </span>
<span class="sd">    Note:</span>
<span class="sd">        None values will not be defined in the generated file and default</span>
<span class="sd">        Graphviz values will be used. Opts overrides color and width</span>
<span class="sd">        definitions.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">Edge</span><span class="p">(</span>
        <span class="n">origin</span><span class="o">=</span><span class="n">o</span>
        <span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="n">t</span>
        <span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s2">&quot;-&gt;&quot;</span>
        <span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="p">(</span> <span class="p">{}</span>
            <span class="o">|</span> <span class="p">({}</span> <span class="k">if</span> <span class="n">c</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">{</span>
                <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;&quot;</span><span class="si">{</span><span class="n">rgb_to_hexstr</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="w"> </span><span class="n">inc_hash</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="si">}</span><span class="s1">&quot;&#39;</span><span class="p">})</span>
            <span class="o">|</span> <span class="p">({}</span> <span class="k">if</span> <span class="n">w</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">{</span><span class="s2">&quot;penwidth&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">w</span><span class="p">)})</span>
            <span class="o">|</span> <span class="p">({}</span> <span class="k">if</span> <span class="n">opts</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">opts</span><span class="p">)))</span></div>



<div class="viewcode-block" id="build_dotedges">
<a class="viewcode-back" href="../../../api/rnets.plotter.utils.html#rnets.plotter.utils.build_dotedges">[docs]</a>
<span class="k">def</span> <span class="nf">build_dotedges</span><span class="p">(</span>
    <span class="n">r</span><span class="p">:</span> <span class="n">Reaction</span>
    <span class="p">,</span> <span class="n">width</span><span class="p">:</span> <span class="nb">float</span>
    <span class="p">,</span> <span class="n">color</span><span class="p">:</span> <span class="n">Color</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">C_BLACK</span>
    <span class="p">,</span> <span class="n">reverse</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Edge</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Converts a `Reaction` into one or more dot :obj:`Edge`.</span>

<span class="sd">    Args:</span>
<span class="sd">        r (:obj:`Reaction`): Reaction to convert.</span>
<span class="sd">        width (float): Width of the reaction arrow.</span>
<span class="sd">        color (:obj:`Color`, optional): Color of the arrow. Defaults to</span>
<span class="sd">            :obj:`C_BLACK`.</span>
<span class="sd">        reverse (bool, optional): If True, invert the order of the reactants</span>
<span class="sd">            and the products.</span>

<span class="sd">    Returns:</span>
<span class="sd">        :obj:`Iterator[Edge]`: </span>
<span class="sd">            Iterator with the generated dot :obj:`Edge` corresponding to the </span>
<span class="sd">            :obj:`Reaction` with the given width and color.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">sel_col</span><span class="p">:</span> <span class="n">Color</span> <span class="o">|</span> <span class="kc">None</span>
    <span class="k">match</span> <span class="p">(</span><span class="n">color</span><span class="p">,</span> <span class="n">r</span><span class="o">.</span><span class="n">visible</span><span class="p">):</span>
        <span class="k">case</span><span class="w"> </span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="k">_</span><span class="p">):</span> <span class="n">sel_col</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">case</span><span class="w"> </span><span class="p">(</span><span class="k">_</span><span class="p">,</span> <span class="n">Visibility</span><span class="o">.</span><span class="n">GREY</span><span class="p">):</span> <span class="n">sel_col</span> <span class="o">=</span> <span class="n">rgb_achromatize</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>
        <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span> <span class="n">sel_col</span> <span class="o">=</span> <span class="n">color</span>

    <span class="n">rs</span><span class="p">,</span> <span class="n">ps</span> <span class="o">=</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">compounds</span><span class="p">)</span> <span class="k">if</span> <span class="n">reverse</span> <span class="k">else</span> <span class="n">r</span><span class="o">.</span><span class="n">compounds</span>

    <span class="k">return</span> <span class="n">starmap</span><span class="p">(</span>
        <span class="n">partial</span><span class="p">(</span><span class="n">build_dotedge</span><span class="p">,</span> <span class="n">opts</span><span class="o">=</span><span class="n">r</span><span class="o">.</span><span class="n">opts</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">sel_col</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="n">width</span><span class="p">)</span>
        <span class="p">,</span> <span class="n">gen_react_arrows</span><span class="p">(</span><span class="n">rs</span><span class="p">,</span> <span class="n">ps</span><span class="p">))</span></div>



<div class="viewcode-block" id="nodecolor_sel">
<a class="viewcode-back" href="../../../api/rnets.plotter.utils.html#rnets.plotter.utils.nodecolor_sel">[docs]</a>
<span class="k">def</span> <span class="nf">nodecolor_sel</span><span class="p">(</span>
    <span class="n">c_norm</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">float</span><span class="p">],</span> <span class="n">Color</span><span class="p">]</span>
    <span class="p">,</span> <span class="n">fg_c</span><span class="p">:</span> <span class="n">Color</span> <span class="o">=</span> <span class="n">C_BLACK</span>
    <span class="p">,</span> <span class="n">fg_alt</span><span class="p">:</span> <span class="n">Color</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">,</span> <span class="n">lum_threshold</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">float</span><span class="p">,</span> <span class="n">Visibility</span><span class="p">],</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Color</span><span class="p">,</span> <span class="n">Color</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a function that takes an energy as input and returns the</span>
<span class="sd">    assigned color for the background of the node and the foreground.</span>

<span class="sd">    Args:</span>
<span class="sd">        c_norm (Function taking a float as input and returns a :obj:`Color`):</span>
<span class="sd">            Color normalizer that will be used to compute the color of the</span>
<span class="sd">            node background. See :obj:`network_color_enery_interp`.</span>
<span class="sd">        fg_c (:obj:`Color`, optional): Color of the text. Defaults to</span>
<span class="sd">            :obj:`C_BLACK`.</span>
<span class="sd">        fg_alt (:obj:`Color`, optional): If set, alternative :obj:`Color` for</span>
<span class="sd">            the text if the luminance is below the a certain</span>
<span class="sd">            threshold. Defaults to None.</span>
<span class="sd">        lum_threshold (float, optional): If set, threshold of the luminance. If</span>
<span class="sd">            None, the default value in :obj:`color_sel_lum` will be used. This</span>
<span class="sd">            argument has no effect if :attr:`fg_alt` is not defined. Ideally,</span>
<span class="sd">            a value between 0. and 1. Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        :obj:`Callable(Compound) -&gt; tuple[Color, Color]` :</span>
<span class="sd">            A function that given a :obj:`Compound` returns a tuple of two</span>
<span class="sd">            :obj:`Color` s, the first being the background color and the second</span>
<span class="sd">            one being the color of the font.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">fg_alt</span><span class="p">:</span>
        <span class="k">def</span> <span class="nf">fg_fn</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">Color</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Color</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">color_sel_lum</span><span class="p">(</span><span class="n">fg_c</span><span class="p">,</span> <span class="n">fg_alt</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">lum_threshold</span> <span class="ow">or</span> <span class="mf">0.5</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">def</span> <span class="nf">fg_fn</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">Color</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Color</span><span class="p">:</span> <span class="k">return</span> <span class="n">fg_c</span>

    <span class="k">def</span> <span class="nf">out_fn</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">v</span><span class="p">:</span> <span class="n">Visibility</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Color</span><span class="p">,</span> <span class="n">Color</span><span class="p">]:</span>
        <span class="n">bg_c</span><span class="p">:</span> <span class="n">Color</span> <span class="o">=</span> <span class="n">c_norm</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">v</span> <span class="o">==</span> <span class="n">Visibility</span><span class="o">.</span><span class="n">GREY</span><span class="p">:</span>
            <span class="n">bg_c</span> <span class="o">=</span> <span class="n">rgb_achromatize</span><span class="p">(</span><span class="n">bg_c</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">bg_c</span><span class="p">,</span> <span class="n">fg_fn</span><span class="p">(</span><span class="n">bg_c</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">out_fn</span></div>



<div class="viewcode-block" id="build_glob_opt">
<a class="viewcode-back" href="../../../api/rnets.plotter.utils.html#rnets.plotter.utils.build_glob_opt">[docs]</a>
<span class="k">def</span> <span class="nf">build_glob_opt</span><span class="p">(</span>
    <span class="n">cfg</span><span class="p">:</span> <span class="n">GraphCfg</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">OptsGlob</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Given a certain :obj:`GraphCfg`, build a dictionary containing the dot</span>
<span class="sd">    options for the graph, the node and the edges.</span>

<span class="sd">    Args:</span>
<span class="sd">        cfg (:obj:`GraphCfg`): Configuration to use to generate the dictionary.</span>

<span class="sd">    Returns:</span>
<span class="sd">        :obj:`OptsGlob`: </span>
<span class="sd">            With the given dictionary. Using graph, node and edge</span>
<span class="sd">            as keys and their corresponding :obj:`Opts` as values.</span>
<span class="sd">            None: If no Opts are found.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># After dealing with the type checker, this is the less problematic</span>
    <span class="c1"># solution to convince it that there are no None values in the dictionary.</span>
    <span class="n">nms</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;graph&quot;</span><span class="p">,</span> <span class="s2">&quot;node&quot;</span><span class="p">,</span> <span class="s2">&quot;edge&quot;</span><span class="p">)</span>
    <span class="n">os</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Opts</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">opts</span><span class="p">,</span> <span class="n">cfg</span><span class="o">.</span><span class="n">node</span><span class="o">.</span><span class="n">opts</span><span class="p">,</span> <span class="n">cfg</span><span class="o">.</span><span class="n">edge</span><span class="o">.</span><span class="n">opts</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">nms</span><span class="p">,</span> <span class="n">os</span><span class="p">)</span> <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">}</span> <span class="ow">or</span> <span class="kc">None</span></div>

</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Sergio Pablo-García.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>